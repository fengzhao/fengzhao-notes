# 消息队列概述





**消息**

“消息”是在两台计算机间传送的数据单位。

消息可以非常简单，例如只包含文本字符串；也可以更复杂，可能包含嵌入对象。







**队列**

队列(Queue)队列是一种先进先出(FIFO)的数据结构。



**消息队列**

消息队列是一个存放消息的容器，消息队列是分布式系统中的重要组件，使用消息队列主要是为了**通过异步处理提高系统性能、削峰、降低系统耦合性**。



## 消息队列的使用场景



- **项目解耦**：不同的项目或模块可以使用消息中间件进行数据的传递，从而可以保证模块的相对独立，实现解耦。
  - 有了消息队列，订单系统和库存系统都和消息队列打交道，所以完全解耦了
- **流量削峰**：可以将突发的流量 (如秒杀数据) 写入消息中间件，然后由多个消费者进行异步处理。
- **弹性伸缩**：可以通过对消息中间件进行横向扩展来提高系统的处理能力和吞吐量。
- **发布订阅**：可以用于任意的发布订阅模式中。
- **异步处理**：当我们不需要对数据进行立即处理，或者不关心数据的处理结果时，可以使用中间件进行异步处理。
- **冗余存储**：消息中间件可以对数据进行持久化存储，直到你消费完成后再进行删除。



https://github.com/doocs/advanced-java/blob/main/docs/high-concurrency/why-mq.md

## AMQP协议

AMQP (Advanced Message Queuing Protocol) 是一个提供统一消息服务的应用层通讯协议，为消息中间件提供统一的开发规范。

不同客户端可以将消息投递到消息队列中间件上，或从上面获取消息；发送消息和接收消息的客户端可以采用不同的语言开发、不同的技术实现，但必须遵循相同的 AMQP 协议。AMQP 协议本身包括以下三层：

- **Module Layer**：位于协议最高层，主要定义了一些供客户端调用的命令，客户端可以利用这些命令实现自己的业务逻辑。
  - 例如：可以使用 Queue.Declare 命令声明一个队列或者使用 Basic.Consume 订阅消费一个队列中的消息。
- **Session Layer**：位于中间层，主要负责将客户端的命令发送给服务器，再将服务端的应答返回给客户端，主要为客户端与服务器之间的通信提供可靠性同步机制和错误处理。
- **Transport Layer**：位于最底层，主要传输二进制数据流 ，提供帧的处理、信道复用、错误检测和数据表示等。





