# 自动侦测



自动侦测（Auto detect）是一种利用ICMP的Request/Reply报文，定期检测网络连通状况的功能。

自动侦测的对象是侦测组（目的IP地址的集合）

侦测的结果反映出了当前网络的连通状态，即目的主机可达或不可达，从而保证设备能够及时发现网络中存在的问题，并产生相应的动作。



```bash
detect-group 1, detect-list 1 ip address 142.1.1.1, timer loop 5

# 这三条命令共同设置了一个链路探测机制。虽然参考资料中没有明确提及 detect-group 命令，但其功能与资料中描述的 track 或 BFD 类似，用于监控指定下一跳的可达性 
# detect-group 1：定义一个探测组，编号为1。
# detect-list 1 ip address 142.1.1.1：将IP地址 142.1.1.1 加入到探测组1的探测列表中，作为探测目标。
# timer loop 5：设置探测周期为5秒。
# 作用：设备会每隔5秒检查一次到IP地址 142.1.1.1 的连通性。

ip route-static 0.0.0.0 0.0.0.0 142.1.1.1 preference 60 detect-group 1

# 这条命令配置了一条主用的静态默认路由
# ip route-static 0.0.0.0 0.0.0.0: 表示这是一条默认路由，用于转发目的地址不在路由表中的所有数据包。
# next-hop-address 142.1.1.1: 指定该路由的下一跳地址为 142.1.1.1 13。
# preference 60: 设置该路由的优先级为60。路由的优先级数值越小，代表优先级越高。60是静态路由的默认优先级。
# detect-group 1: 将此路由与之前定义的探测组1关联。这条路由的生效与否取决于探测组1的探测结果。
# 作用：当 142.1.1.1 可达时，这条高优先级的默认路由生效，成为当前活动路由。

ip route-static 0.0.0.0 0.0.0.0 Dialer 0 preference 100

# 这条命令配置了一条备用（浮动）的静态默认路由 1。
# Dialer 0: 指定该路由的出接口为 Dialer 0，这通常是用于拨号连接（如PPPoE）的接口。
# preference 100: 设置该路由的优先级为100。因为100大于60，所以这条路由的优先级低于主用路由。
# 作用：这条路由平时处于非激活状态。只有当主用路由（优先级为60）因为下一跳不可达而失效时，这条优先级较低的路由才会生效，接管数据转发。
```

