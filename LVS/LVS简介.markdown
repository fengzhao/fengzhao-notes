# LVS 简介





LVS 是 Linux Virtual Server 的简写，意即 Linux 虚拟服务器，是一个虚拟的服务器集群系统，可以在 UNIX/LINUX 平台下实现负载均衡集群功能。

该项目在 1998 年 6 月由章文嵩博士组织成立，是中国国内最早出现的自由软件项目之一。那时他还在国防科技大学读博。

LVS 最初是他在大学期间的玩具，随着后来使用的用户越来越多，LVS 也越来越完善，最终集成到了 Linux 的内核中。

不少开源牛人都为 LVS 开发过辅助工具和辅助组件，最出名的就是 Alexandre 为 LVS 编写的 Keepalived 。

> 在 Linux 内核 2.2 时，IPVS 就已经以内核补丁的形式出现。
>
> 从 2.4.23 版本开始时，IPVS 软件就是合并到 Linux 内核的常用版本的内核补丁的集合。
>
> 从 2.4.24 以后，IPVS已经成为 Linux 官方标准内核的一部分。
>

它最初专门用于监控 LVS ，后来加入了通过 VRRP 实现高可用的功能。





> 
>
> 22年前国内的互联网还处在早期阶段，一台服务器加载一个网站都忙不过来，要多台服务器来解决，这就需要做负载均衡。
>
> 章文嵩发现，Linux内核里并没有这个功能，于是，他花了两个星期写了LVS软件放在网上，并给出使用文档。那是1998年5月，他还在国防科技大学读博。
>
> 一个星期内，他收到了诸多反馈。印象最深的是，一个澳洲人在社区网站用负载均衡调度网站政策来上网，这让他觉得很有成就感。
>
> 很快，开发者们对这款软件提出更多需求，他与来自全球的不同开发者进行交流，乐此不彼地解决问题。
>
> 功不唐捐，LVS软件在负载均衡领域备受欢迎，他也成为Linux内核的重要开发者，但仍旧坚持开源。
>
> 参与开源实际上给他打开了一扇技术之窗。在与开发者互动的过程中，对章文嵩称写代码、设计系统等技术能力得到很大提升，也让其积累了诸多开发经验。在他看来，开发者实际上投入的精力，都有回报，“实际上真正把事情做好，所有的回报都会到来。”
>
> 章文嵩的开源热情不减。多年来，他四处布道，鼓励技术人员参与开源项目。
>
> 在阿里巴巴工作的近7年里，他历任淘宝网资深技术总监、阿里开源委员会主席、阿里云CTO等职务，其中负责开源了淘宝底层技术平台的上百个软件项目。
>
> 1998 年，章文嵩创办 LVS(Linux Virtual Server，Linux 虚拟服务器)开源软件拉开了国内开源产业的序幕，也成为了开源产业的领军人物。
>
> 在加入滴滴之前，章文嵩曾在阿里巴巴任职近七年，历任淘宝网资深技术总监、淘宝技术委员会主席、阿里副总裁、阿里开源委员会主席、阿里云 CTO 等。
>
> 负责 ECS、RDS、OSS、CDN、SLB 等云产品，同时也在积极活跃开源事业。
>
> 章文嵩历任淘宝技术委员会主席、阿里集团开源委会会主席，引入开源文化，使得阿里因开源而受益，同时也提高了阿里的技术品牌和影响力。
>
> 2016 年，在章文嵩的加盟下，滴滴也开始加大开源力度。据了解，滴滴超五千多名研发人员所搭建维护的技术框架离不开开源软件的支持。
>
> 通过大量自主开发软件与部分应用开源软件，滴滴构建了全世界规模最大的出行平台。
>
> 滴滴在 Github 全球组织排名已进入前 100 名。其源项目从单一的前端项目，覆盖技术领域扩大至人工智能、小程序、智慧交通、中间件、前端框架、研发工具等。
>
> 不过，章文嵩曾表示，"把软件开源出来只是万里长征的第一步，后续还要进行维护，持续投入才能把开源软件做得更好。"
>
> 
>
> 在滴滴任职期间，章文嵩辖下的，是技术中的基础问题，例如滴滴云、基础架构部、运维部、系统部、大数据架构部、IT&机器学习部、数据平台与数据治理部等。
>
> 在滴滴期间章文嵩也一直在推广开源理念，在章文嵩的带领下，滴滴受益于开源快速发展的同时降低了成本。
>
> 滴滴从2017年开始相继开源了23个项目开源，累计获得Star数36000多个，其中包括移动开发、中间件、系动软件、前端、研发、测试、智慧交通、人工智能等领域。
>
> 2021年初，章文嵩已经决定从滴滴离职，结合七八月份的滴滴上市和整治，现在回过头看，章文嵩还是有先见之明。

























LVS的全称是Linux virtual server，即Linux虚拟服务器。

之所以是虚拟服务器，是因为 LVS 自身是个负载均衡器(director)，不直接处理请求，而是将请求转发至位于它后端真正的服务器 realserver 上。

LVS 是四层(传输层tcp/udp)、七层(应用层)的负载均衡工具。

只不过大众一般都使用它的四层负载均衡功能 ipv，而七层的内容分发负载工具 ktcpvs(kernel tcp virtual server)不怎么完善，使用的人并不多。

ipvs是集成在内核中的框架，可以通过用户空间的程序`ipvsadm`工具来管理，该工具可以定义一些规则来管理内核中的ipvs。就像iptables和netfilter的关系一样。



LVS 负载均衡调度技术是在 Linux 内核中实现的，被称之为 Linux 虚拟服务器（Linux Virtual Server）。

我们使用该软件配置 LVS 时候，不能直接配置内核中的 ipvs，而需要使用 ipvs 的管理工具 ipvsadm 进行管理。

后文我们会讲通过 keepalive 软件直接管理 ipvs，并不是通过 ipvsadm 来管理ipvs。ipvs的管理工具ipvsadm管理ipvs。





# IPVS



ipvs全称为IP虚拟服务器（IP Virtual Server，简写为*IPVS*）。是运行在LVS下的提供负载平衡功能的一种技术。

ipvs是在linux内核netfilter模块之上实现的四层负载均衡模块。