



# 交换机基本概念和工作原理



交换机是一种在数据链路层工作的网络设备，它有多个端口，可以连接不同的设备。交换机根据每个帧中的目标 MAC 地址决定向哪个端口发送数据，此时它需要参考 "转发表"。

转发表并非手动设置，而是交换机自动学习得到的。当某个设备向交换机发送帧时，交换机将帧的源 MAC 地址和接口对应起来，作为一条记录添加到转发表中。



交换机之所以能实现这一功能，是因为交换机内部有一个MAC地址表，MAC地址表记录了网络中所有MAC地址与该交换机各端口的对应信息。

某一数据帧需要转发时，交换机根据该数据帧的目的MAC地址来查找MAC地址表，从而得到该地址对应的端口，即知道具有该MAC地址的设备是连接在交换机的哪个端口上，然后交换机把数据帧从该端口转发出去。

- 交换机根据收到数据帧中的源MAC地址建立该地址同交换机端口的映射，并将其写入MAC地址表中。
- 交换机将数据帧中的目的MAC地址同已建立的MAC地址表进行比较，以决定由哪个端口进行转发。
- 如数据帧中的目的MAC地址不在MAC地
  



从事光通信网络行业的朋友们，一定不会对接入层、汇聚层、核心层这些跟交换机相关的网络术语感到陌生。

它们究竟代表什么含义，有什么样的区别呢？什么样的交换机适合放在接入层、汇聚层和核心层呢？

首先我们需要明确的一个概念就是：接入层交换机、汇聚层交换机、核心层交换机并非是交换机的分类和属性，只是由其所执行的任务来划分的。

它们没有固定要求，主要看网络环境的大小、设备的转发能力以及在网络结构中所处位置。

例如，同一个二层交换机在不同的网络结构中，可能用在接入层，也可能用在汇聚层。

当用在接入层时，该交换机被称为接入层交换机，同理，用在汇聚层时，该交换机被称为汇聚层交换机。

接入层：最贴近终端的那个交换机，比如在企业组网中，区域A的所有PC的网线，全部都接入到区域A的交换机，这个就叫接入层交换机。

汇聚层：

# 华为交换机



华为（Huawei）作为全球领先的电信解决方案供应商，其产品和业务的分布十分广泛，是众多通信行业的公司学习的典范。

华为品牌系列交换机，是信息化系统中用经常遇到的网络设备，特别是在国产化和安可的要求之后，其中24与48口比较多。现在将华为交换机的一些常用配置整理一下，记录备查。

华为具有网络安全设备模拟器eNSP（以VirtualBox、WinPcap、Wireshark为底层），如果需要下载和安装eNSP，请自行爬网寻找下载。



在交换机领域，华为提供的面向下一代数据中心和园区的高性能交换机，可以覆盖核心、汇聚、接入功能，充分满足企业的灵活组网需求。

 https://support.huawei.com/enterprise/zh/category/switch-pid-9856733



- **数据中心交换机**

数据中心交换机用于连接服务器/IP存储，目前主流架构：**万兆接入，40G/100G骨干。**

- **园区交换机**

园区网交换机说简单点，主要用于连接PC/摄像头，目前主流架构：**万兆骨干，千兆到桌面。**



### 华为交换机命名规则





#### 华为交换机的型号后缀含义





## 华为交换机配置



#### 新设备初始化

新交换机加电后，使用电脑的COM口连接交换机的Console口，连接成功后屏幕提示是否设置密码，建议设置，完成后进入系统配置本机地址：

```shell
<HUAWEI>system-view
Enter system view, return user view with Ctrl+Z.
[HUAWEI]vlan 1
[HUAWEI-vlan1]ip address 192.168.1.254 255.255.255.0
```

然后就可以在浏览器地址栏中输入：http://192.168.1.254，使用Web方式配置交换机（对安全没有特殊要求的环境，如果使用在等保或分保等安全环境中，建议只使用Console口直连或者加上SSH方式）。



#### 华为交换机的登录方式

新设备初始化之后，一般可以设置web，telnet，ssh（华为设备里面也叫stelnet）这几种模式登录来进行配置和管理。

#### 华为交换机的模式



用户模式：登陆设备后，直接进入用户模式，只能执行少量查看配置的命令；

```shell
<HUAWEI>
```



视图模式：用户模式下，输入system-view进入视图模式，可执行设备全局配置的命令；

```shell
<HUAWEI>system-view
Enter system view, return user view with Ctrl+Z.
[HUAWEI]
```





局部配置模式：视图模式下，输入局部配置命令，如interface GE 1/0/0，进入GE1/0/0端口配置模式，此外局部配置模式有很多种，可根据不同需求进入vlan配置模式、端口聚合配置模式等，可输入？，查看当前模式下，能执行哪些命令；

```shell
[HUAWEI]interface GigabitEthernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1]
```





### 常用命令总结



```shell
# 进入 system-view 模式
<Huawei>system-view
Enter system view, return user view with Ctrl+Z.
[Huawei]

discur

# 更改交换机名称
[Huawei]sysname SW-ACC-CORE-1
[SW-ACC-CORE-1]



# 保存配置
<SW-ACC-CORE-1>save
The current configuration will be written to the device.
Are you sure to continue?[Y/N]y
Info: Please input the file name ( *.cfg, *.zip ) [vrpcfg.zip]:
Aug 31 2016 09:50:33-08:00 SW-ACC-CORE-1 %%01CFM/4/SAVE(l)[0]:The user chose Y when
 deciding whether to save the configuration to the device.
Now saving the current configuration to the slot 0.
Save the configuration successfully.
<SW-ACC-CORE-1>
```

