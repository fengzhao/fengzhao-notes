# 部署 jenkins 



```shell
# https://www.cnblogs.com/hellxz/p/install_jenkins.html


# centos7 安装 jenkins

# 安装jdk1.8
wget  https://repo.huaweicloud.com/java/jdk/8u181-b13/jdk-8u181-linux-x64.tar.gz
rpm -ivh https://repo.huaweicloud.com/java/jdk/8u181-b13/jdk-8u181-linux-x64.rpm
yum -y install git


# rpm 方式安装jenkins
sudo wget -O /etc/yum.repos.d/jenkins.repo  https://pkg.jenkins.io/redhat-stable/jenkins.repo
sudo rpm --import https://pkg.jenkins.io/redhat-stable/jenkins.io.key
sudo yum upgrade
sudo yum install jenkins java-1.8.0-openjdk-devel
sudo systemctl daemon-reload

# jenkins官方镜像源
http://mirrors.jenkins.io/
# 清华大学jenkins镜像源
https://mirrors.tuna.tsinghua.edu.cn/jenkins/

# tomcat方式安装Jenkins
wget  https://mirrors.cnnic.cn/apache/tomcat/tomcat-9/v9.0.41/bin/apache-tomcat-9.0.41.tar.gz

# jenkins-war包下载
# wget http://mirrors.jenkins.io/war-stable/latest/jenkins.war
wget https://mirrors.huaweicloud.com/jenkins/war/latest/jenkins.war
# 中文社区
# https://jenkins-zh.cn/tutorial/management/mirror/

# rpm包下载
http://mirrors.jenkins.io/redhat-stable/jenkins-2.235.3-1.1.noarch.rpm
# 所以也可以下载rpm包后，rpm -ivh 去安装

# jenkins进程通过systemctl start jenkins的方式启动

# /usr/lib/jenkins/jenkins.war    　　　　　WAR包 
# /etc/sysconfig/jenkins       　　　　　　　配置文件
# /var/lib/jenkins/        　　　　　　　　　默认的JENKINS_HOME目录
#　/var/log/jenkins/jenkins.log    　　　　Jenkins日志文件


# jenkins插件安装
# 插件下载地址为国内地址 



# 安装中文汉化插件

# jenkins用户角色权限插件

# Role-Based 插件

# 修改权限策略为Role-Based，可以提升到更细致权限

# Global roles
# Project roles
# Slave roles



# 凭证管理插件 Credentials Binding 插件
```





### docker 方式部署jenkins

```shell
mkdir -p /home/jenkins_root/{jenkins_data,jenkins_home}
chown -R 1000:1000  /home/jenkins_root/jenkins_data 
chown -R 1000:1000  /home/jenkins_root/jenkins_home

cd /home/jenkins_root/

wget https://raw.githubusercontent.com/fengzhao/fengzhao-notes/master/DevOps/jenkins/docker-compose.yml

docker pull ghcr.io/fengzhao-study-notes/blueocean:latest


docker-compose up -d 


docker exec  jenkins_root_jkenkins_1 cat /var/jenkins_home/secrets/initialAdminPassword


```





# pipeline入门



> 从某种抽象层次上讲，部署流水线《Deployment pipeline》是指软件从版本控制库到用户手中这一过程的自动化表现。
>
> ​																										——《持续交付—发布可靠软件的系统方法》
>
> 



按照《持续交付》中定义，Jenkins就是支持部署流水线的。Jenkins 1.x 只能通过界面手动操作来部署，Jenkins 2.x 支持 pipeline as code ，可以通过”代码“来描述部署流水线。



Jenkinsfile 是一个文本文件，也就是部署流水线在 Jenkins 中的表现形式。就像 gitlab 中的 .gitlab-ci.yml 文件一样。所有部署流水线的逻辑都写在 Jenkinsfile 中。







## pipeline 语法的选择





## pipeline 的组成



Jekins pipeline 其实就是基于 groovy 语言实现的一种 DSL（领域特定语言），用于描述整条流水线是如何进行的。

流水线的内容包括：执行编译、打包、测试、输出测试报告等。



pipeline 最简单的结构：



```groovy
pipeline {
	agent any 
    stages {
        stage('build') {
            steps {
                echo "hello world"
            }
        }
    }
  
}

// pipeline代表整条流水线



// steps 
```



### post 部分





```groovy
pipeline {
	agent any 
    stages {
        stage('build') {
            steps {
                echo "hello world"
            }
        }
    }
  
}
```

